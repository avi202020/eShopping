# Application Properties
spring:
  application:
    name: SpringSecurity-Data-Application
  # Jpa Properties
  datasource:
    url: ${spring.datasource.url}
    username: ${spring.datasource.username}
    password: ${spring.datasource.password}
  jpa:
    hibernate:
      ddl-auto: update

  # Spring Session properties
  session:
    jdbc:
      table-name: SPRING_SESSION
      initialize-schema: always
  devtools:
    restart:
      enabled: true

## Server Properties
server:
  port: ${server.port}
  servlet:
    session:
      cookie:
        secure: false
        http-only: true

management:
  endpoints:
    web:
      exposure:
        include: ["health","info"]
  endpoint:
    auditevents:
      enabled: true

# Logging
logging:
  file: /Users/pjadda/ELK-Stack/logback/springsecuritydata.log

# Bucket4J properties
bucket4j:
  enabled: true

  filters:
    - cache-name: buckets
      url: /*
      metrics:
        tags:
          - key: IP
            expression: getRemoteAddr()
            types: REJECTED_COUNTER # for data privacy reasons the IP should only be collected on bucket rejections
          - key: USERNAME
            expression: "@bucket4jSecurityService.username() != null ? @bucket4jSecurityService.username() : 'anonymous'"
          - key: URL
            expression: request.getRequestURI()
      rate-limits:
        - bandwidths:
            - capacity: 5
              time: 10
              unit: seconds
